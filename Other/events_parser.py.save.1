#!/usr/bin/env python3
import sys, re, json, time
smartflow_dict = {
    'date': "null",
    'time': "null",
    'light_1': 0,
    'light_2': 0,
    'light_3': 0,
    'door_sensor': 0,
    'window_sensor': 0,
    'motion_sensor': 0
    }
while True:
    try:
        data = sys.stdin.readline()
    except KeyboardInterrupt:
        break
    if not data:
        break
#    print(data)
    log = re.match(r'(.*) - (.*)', data)
    log_id = log.group(1).split()
    log_status = log.group(2).split()
    smartflow_dict['date'] = log_id[0]
    smartflow_dict['time'] = log_id[1]
    if log_id[2] == '[vent.ItemStateChangedEvent]':
        if "_1_brightness" in log_status[0]:
            smartflow_dict['light_1'] = log_status[5][0]
        elif "_2_brightness" in log_status[0]:
            smartflow_dict['light_2'] = log_status[5][0]
        elif "_3_brightness" in log_status[0]:
            smartflow_dict['light_3'] = log_status[5][0]
        elif "_presence" in log_status[0]:
            if log_status[5] == "ON":
                smartflow_dict['motion_sensor'] = 1
            else:
                smartflow_dict['motion_sensor'] = 0
            print(smartflow_dict)
    elif log_id[2] == '[temChannelLinkRemovedEvent]':
        if "Multipurpose_Sensor_1" in log_status[1]:
            smartflow_dict['door_sensor'] = 0
        else:
            smartflow_dict['window_sensor'] = 0
        print(smartflow_dict)
    elif log_id[2] == '[.ItemChannelLinkAddedEvent]':
        if "Multipurpose_Sensor_1" in log_status[1]:
            smartflow_dict['door_sensor'] = 1
        else:
            smartflow_dict['window_sensor'] = 1
        print(smartflow_dict)
    log_info_string = json.dumps(smartflow_dict)






